# è¿”å›å‡½æ•°

# å¯å˜å‚æ•°çš„æ±‚å’Œå‡½æ•°
def calc_sum(*args):
    ax = 0
    for n in args:
        ax = ax + n
    return ax
    
# ä¸éœ€è¦ç«‹åˆ»æ±‚å’Œï¼Œåœ¨åé¢ä»£ç ä¸­æ®éœ€è¦å†è®¡ç®—
def lazy_sum(*args): 
    def sum(): # â€œé—­åŒ…ï¼ˆClosureï¼‰â€ç¨‹åºç»“æ„
        ax = 0
        for n in args:
            ax = ax + n
        return ax
    return sum
# è°ƒç”¨lazy_sum()æ—¶ï¼Œè¿”å›çš„å¹¶ä¸æ˜¯æ±‚å’Œç»“æœï¼Œè€Œæ˜¯æ±‚å’Œå‡½æ•°
f = lazy_sum(1, 3, 5, 7, 9)
# é—­åŒ…(Closure)-åœ¨å‡½æ•°lazy_sumä¸­åˆå®šä¹‰äº†å‡½æ•°sum
# å†…éƒ¨å‡½æ•°sumå¯ä»¥å¼•ç”¨å¤–éƒ¨å‡½æ•°lazy_sumçš„å‚æ•°å’Œå±€éƒ¨å˜é‡
# å½“lazy_sumè¿”å›å‡½æ•°sumæ—¶ï¼Œç›¸å…³å‚æ•°å’Œå˜é‡éƒ½ä¿å­˜åœ¨è¿”å›çš„å‡½æ•°ä¸­

# è°ƒç”¨å‡½æ•°fæ—¶ï¼Œæ‰çœŸæ­£è®¡ç®—æ±‚å’Œ
print(f())
# å³ä½¿ä¼ å…¥ç›¸åŒçš„å‚æ•°
# å½“è°ƒç”¨lazy_sum()æ—¶ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°
f1 = lazy_sum(1, 3, 5, 7, 9) # å¥½æ¯”ä¸¤ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸åŒçš„å‡½æ•°
f2 = lazy_sum(1, 3, 5, 7, 9)

# é—­åŒ…
# å½“ä¸€å‡½æ•°è¿”å›äº†ä¸€ä¸ªå‡½æ•°åï¼Œå…¶å†…éƒ¨çš„å±€éƒ¨å˜é‡è¿˜è¢«æ–°å‡½æ•°å¼•ç”¨
# è¿”å›çš„å‡½æ•°å¹¶æ²¡æœ‰ç«‹åˆ»æ‰§è¡Œï¼Œè€Œæ˜¯ç›´åˆ°è°ƒç”¨äº†f()æ‰æ‰§è¡Œ
def count():
    fs = []
    for i in range(1, 4):
        def f():
             return i*i
        fs.append(f)
    return fs
# f1() = f2() = f3() = 9
# åŸå› å°±åœ¨äºè¿”å›çš„å‡½æ•°å¼•ç”¨äº†å˜é‡iï¼Œä½†å®ƒå¹¶éç«‹åˆ»æ‰§è¡Œ
# ç­‰åˆ°3ä¸ªå‡½æ•°éƒ½è¿”å›æ—¶ï¼Œå®ƒä»¬æ‰€å¼•ç”¨çš„å˜é‡iå·²å˜æˆ3ï¼Œæœ€ç»ˆç»“æœæ•…ä¸º9
f1, f2, f3 = count()

# !è¿”å›å‡½æ•°ä¸è¦å¼•ç”¨ä»»ä½•å¾ªç¯å˜é‡ï¼Œæˆ–è€…åç»­ä¼šå‘ç”Ÿå˜åŒ–çš„å˜é‡ã€‚
# ä¸€å®šè¦å¼•ç”¨å¾ªç¯å˜é‡ï¼Œå°±å†åˆ›å»ºä¸€ä¸ªå‡½æ•°
# ç”¨è¯¥å‡½æ•°çš„å‚æ•°ç»‘å®šå¾ªç¯å˜é‡å½“å‰çš„å€¼ï¼Œæ— è®ºè¯¥å¾ªç¯å˜é‡åç»­å¦‚ä½•æ›´æ”¹
# å·²ç»‘å®šåˆ°å‡½æ•°å‚æ•°çš„å€¼ä¸å˜
def count():
    def f(j):
        def g():
            return j*j
        return g
    fs = []
    for i in range(1, 4):
        fs.append(f(i)) # f(i)ç«‹åˆ»è¢«æ‰§è¡Œï¼Œå› æ­¤içš„å½“å‰å€¼è¢«ä¼ å…¥f()
    return fs
# è¿”å›çš„è¯¥å‡½æ•°å¹¶æœªæ‰§è¡Œï¼Œè¿”å›å‡½æ•°ä¸­ä¸è¦å¼•ç”¨ä»»ä½•å¯èƒ½ä¼šå˜åŒ–çš„å˜é‡
f1, f2, f3 = count()
print(f1())
print(f2())
print(f3())

# Pracice
def createCounter():
    i = 0
    def counter():
        nonlocal i
        i = i + 1
        return i
    return counter

# æµ‹è¯•:
counterA = createCounter()
print(counterA(), counterA(), counterA(), counterA(), counterA()) # 1 2 3 4 5
counterB = createCounter()
if [counterB(), counterB(), counterB(), counterB()] == [1, 2, 3, 4]:
    print('æµ‹è¯•é€šè¿‡!')
else:
    print('æµ‹è¯•å¤±è´¥!')
